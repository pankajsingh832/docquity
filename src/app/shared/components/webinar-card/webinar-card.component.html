<div class="webinar-card h-100" 
     [class.live-card]="webinar().isLive"
     [class.blue-medical-card]="webinar().cardType === 'blue-medical'"
     [class.green-medical-card]="webinar().cardType === 'green-medical'"
     [class.live-video-card]="webinar().cardType === 'live-video'">
  
  <!-- Thumbnail -->
  <div class="thumbnail-container position-relative">
    <!-- Custom medical themed backgrounds -->
    @if (webinar().cardType === 'blue-medical') {
      <div class="medical-content-bg blue-theme">
        <!-- Sponsor logos -->
        <div class="sponsor-logos">
          <div class="logo logo-left">
            <span class="logo-text">COLUMBIA ASIA</span>
            <span class="logo-sub">Hospitality</span>
          </div>
          <div class="logo logo-right">
            <span class="logo-text">docquity</span>
          </div>
        </div>
        
        <!-- Main content -->
        <div class="content-overlay">
          <h2 class="content-title">More Than<br>Skin Deep:<br>Treating Eczema<br>and Allergy</h2>
          
          <!-- Doctor avatar -->
          <div class="doctor-avatar">
            <img 
              [src]="webinar().instructor.avatarUrl" 
              [alt]="webinar().instructor.name"
              class="doctor-image">
          </div>
        </div>
        
        <!-- Additional content -->
        <div class="bottom-content">
          <div class="content-details">
            <span class="detail-line">Dr. Skin dermatologist</span>
            <span class="detail-line">Consultant Dermatologist</span>
            <span class="detail-line">National Dermatology</span>
          </div>
        </div>
      </div>
    } @else if (webinar().cardType === 'green-medical') {
      <div class="medical-content-bg green-theme">
        <!-- Sponsor logos -->
        <div class="sponsor-logos">
          <div class="logo logo-left red-logo">
            <span class="logo-icon">üè•</span>
          </div>
          <div class="logo logo-center yellow-badge">
            <span class="badge-text">üìå</span>
          </div>
          <div class="logo logo-right">
            <span class="logo-text">docquity</span>
          </div>
        </div>
        
        <!-- Main content -->
        <div class="content-overlay green-content">
          <h2 class="content-title">101 Hal tentang PPDS<br>Bedah Umum FKUI dan<br>Karir Bedah Umum</h2>
          
          <!-- Process badge -->
          <div class="process-badge">
            <span class="badge-icon">üîÑ</span>
            <span class="badge-text">E-SKP DALAM PROSES</span>
          </div>
          
          <!-- Doctor info card -->
          <div class="doctor-info-card">
            <img 
              [src]="webinar().instructor.avatarUrl" 
              [alt]="webinar().instructor.name"
              class="doctor-image">
            <div class="doctor-details">
              <span class="doctor-name">dr Yuliardy Limengka,</span>
              <span class="doctor-title">SpB-SubSp(U)</span>
            </div>
          </div>
        </div>
      </div>
    } @else if (webinar().cardType === 'live-video') {
      <!-- Live video background -->
      <div class="live-video-bg">
        <img 
          [src]="webinar().thumbnailUrl" 
          [alt]="webinar().title"
          class="live-video-thumbnail">
        
        <!-- Live controls overlay -->
        <div class="live-controls">
          <div class="live-status">
            <span class="live-badge">üî¥ Live</span>
            <span class="viewer-count">üë• 200+</span>
          </div>
          <div class="live-actions">
            <button class="live-btn">üí¨</button>
            <button class="live-btn">üîá</button>
          </div>
        </div>
      </div>
    } @else {
      <!-- Default thumbnail -->
      <img 
        [src]="webinar().thumbnailUrl" 
        [alt]="webinar().title"
        class="card-img-top thumbnail"
        (error)="onImageError($event)"
        loading="lazy">
    }
    
    <!-- Live indicator for regular cards -->
    @if (webinar().isLive && webinar().cardType !== 'live-video') {
      <div class="live-indicator">
        <span class="badge bg-danger d-flex align-items-center">
          <i class="bi bi-record-circle-fill me-1"></i>
          Live
        </span>
        <span class="participants-count ms-2">
          <i class="bi bi-people-fill me-1"></i>
          {{ webinar().participants }}
        </span>
      </div>
    }
    
    <!-- Duration -->
    <div class="duration-badge">
      {{ webinar().duration }}
    </div>
    
    <!-- Play button overlay -->
    @if (webinar().cardType !== 'live-video') {
      <div class="play-overlay">
        <button class="btn btn-play">
          <i class="bi bi-play-fill"></i>
        </button>
      </div>
    }
  </div>

  <!-- Card content -->
  <div class="card-body p-3">
    <!-- Credits and tags -->
    <div class="d-flex justify-content-between align-items-start mb-2">
      @if (webinar().credits > 0) {
        <span class="badge bg-warning text-dark" 
              [class.text-danger]="webinar().tags && webinar().tags.length > 0 && webinar().tags[0].includes('Expiring')">
          <i class="bi bi-star-fill me-1"></i>
          {{ webinar().credits }} Credits
          @if (webinar().tags && webinar().tags.length > 0 && (webinar().tags[0].includes('till') || webinar().tags[0].includes('Expiring'))) {
            <span class="ms-1">({{ webinar().tags[0] }})</span>
          }
        </span>
      }
      
      @if (webinar().tags && webinar().tags.length > 0 && !webinar().tags[0].includes('till') && !webinar().tags[0].includes('Goes live')) {
        <div class="tags">
          @for (tag of webinar().tags; track tag) {
            <span class="badge bg-light text-muted small">{{ tag }}</span>
          }
        </div>
      }
    </div>

    <!-- Title -->
    <h6 class="card-title mb-2 line-clamp-2">
      {{ webinar().title }}
    </h6>

    <!-- Instructor info -->
    <div class="instructor-info d-flex align-items-center mb-3">
      <img 
        [src]="webinar().instructor.avatarUrl" 
        [alt]="webinar().instructor.name"
        class="instructor-avatar me-2"
        (error)="onAvatarError($event)"
        loading="lazy">
      <div class="instructor-details">
        <div class="instructor-name">by {{ webinar().instructor.name }}</div>
        <div class="instructor-org text-muted small">{{ webinar().instructor.organization }}</div>
      </div>
    </div>

    <!-- Key Highlights section for live webinars -->
    @if (webinar().isLive) {
      <div class="key-highlights mb-3">
        <div class="highlights-header">KEY HIGHLIGHTS</div>
        <p class="highlights-text">Manage chronic and complex diseases</p>
      </div>
    }

    <!-- Related guideline for some cards -->
    @if (webinar().cardType === 'blue-medical' || webinar().cardType === 'green-medical' || webinar().cardType === 'live-video') {
      <div class="related-guideline mb-3">
        <div class="guideline-header">
          <img src="https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=40&h=40&fit=crop" alt="Guide" class="guide-icon">
          <span class="guideline-text">RELATED GUIDELINE</span>
        </div>
        <p class="guideline-title">Diclofenac in post operative pain ma...</p>
      </div>
    }

    <!-- Special scheduling info for upcoming webinars -->
    @if (webinar().isUpcoming && webinar().tags && webinar().tags[0].includes('Goes live')) {
      <div class="schedule-info mb-3">
        <div class="schedule-text">{{ webinar().tags[0] }}</div>
      </div>
    }

    <!-- Action buttons -->
    <div class="card-actions">
      @if (webinar().isLive) {
        <button class="btn btn-dark btn-sm w-100">
          <i class="bi bi-play-circle me-1"></i>
          Watch now
        </button>
      } @else if (webinar().isUpcoming) {
        <div class="d-flex gap-2">
          <button 
            class="btn btn-dark btn-sm flex-grow-1"
            [class.btn-primary]="webinar().isNotificationEnabled"
            [class.text-white]="webinar().isNotificationEnabled">
            <i class="bi bi-bell me-1"></i>
            Notify me
          </button>
        </div>
      } @else {
        <button class="btn btn-dark btn-sm w-100">
          <i class="bi bi-play-circle me-1"></i>
          Watch now
        </button>
      }
    </div>
  </div>
</div>
